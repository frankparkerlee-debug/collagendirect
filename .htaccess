# =====================================
# Collagen Direct - Public Root Rules
# =====================================

RewriteEngine On
RewriteBase /

# Force HTTPS and remove "www"
RewriteCond %{HTTPS} !=on [OR]
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^ https://collagendirect.health%{REQUEST_URI} [L,R=301]

# If someone hits a URL that *includes* /public, strip it out
RewriteCond %{THE_REQUEST} \s/+public/([^\s?]*) [NC]
RewriteRule ^public/(.*)$ /$1 [R=301,L]

# Serve real files/dirs as-is
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Pretty routes â†’ entry files
RewriteRule ^login/?$    login/index.php   [L,QSA]
RewriteRule ^logout/?$   logout/index.php  [L,QSA]
RewriteRule ^portal/?$   portal/index.php  [L,QSA]

# API endpoints your JS calls
RewriteRule ^api/csrf\.php$   api/csrf.php   [L,QSA]
RewriteRule ^api/login\.php$  api/login.php  [L,QSA]

DirectoryIndex index.php index.html